---
title: "GCC and Field Data"
author: "Anna Talucci"
date: "2/24/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Overview

- Evaluated the relationship between GCC and distance from the unburned edge 



- Plot size for field data collection was variable from 4-10m radius plots
- apply 4m buffer

# Packages
```{r, include=FALSE}
library(sp) 
library(rgdal) 
library(raster) 
library(rgeos) # GIS Geometry
library(foreign) # deals with dbf files
library(dplyr)
library(ggplot2)
```


# RGB DATA



alnus_tr1_f07
ans_tr2_f04
ans_tr3_f06
brp_tr1_f09
brp_tr2_f12
cn_tr2_f17
cn_tr1_f15 


# GCC rasters

```{r}
alnus_tr1_f07 = raster("../data/gcc/alnus_tr1_f07_gcc.tif")
ans_tr2_f04 = raster("../data/gcc/ans_tr2_f04_gcc.tif")
ans_tr3_f06 = raster("../data/gcc/ans_tr3_f06_gcc.tif")
brp_tr1_f09 = raster("../data//gcc/brp_tr1_f09_gcc.tif")
brp_tr2_f12 = raster("../data/gcc/brp_tr2_f12_gcc.tif")
cn_tr2_f17 = raster("../data/gcc/cn_tr2_f17_gcc.tif")
cn_tr1_f15 = raster("../data/gcc/cn_tr1_f15_gcc.tif")
```


# Field points and buffers
hs2001 = readOGR("../data/hotspot_data/DL_FIRE_M6_2001/fire_archive_2001.shp", "fire_archive_2001")

## Point Data

Points
```{r}
alnus_tr1_pt = readOGR("../data/field-spatial/point/alnus_tr1_ee_pt.shp", "alnus_tr1_ee_pt")
ans_tr2_pt = readOGR("../data/field-spatial/point/ans_tr2_ee_pt.shp", "ans_tr2_ee_pt") 
ans_tr3_pt = readOGR("../data/field-spatial/point/ans_tr3_ee_pt.shp", "ans_tr3_ee_pt") 

brp_tr1_pt = readOGR("../data/field-spatial/point/bp_tr1_ee_pt.shp", "bp_tr1_ee_pt") 
brp_tr2_pt = readOGR("../data/field-spatial/point/bp_tr2_ee_pt.shp", "bp_tr2_ee_pt") 
cn_tr1_pt = readOGR("../data/field-spatial/point/cn_tr1_ee_pt.shp", "cn_tr1_ee_pt") 
cn_tr2_pt = readOGR("../data/field-spatial/point/cn_tr2_ee_pt.shp", "cn_tr2_ee_pt") 
 
```

```{r}
head(alnus_tr1_pt)
```



## GCC as  function of distance from edge
extract(rasterA,points, buffer=150, fun=mean)

- Choose buffer based on pixel size and maintaining fine scale resolution but aggregating so that values are at the same spatial scale

```{r}

extract_alnus_tr1 = raster::extract(alnus_tr1_f07, alnus_tr1_pt, buffer=1, fun=mean, df=TRUE )
extract_ans_tr2 = raster::extract(ans_tr2_f04, ans_tr2_pt, buffer=1, fun=mean, df=TRUE )
extract_ans_tr3 = raster::extract(ans_tr3_f06, ans_tr3_pt, buffer=1, fun=mean,  df=TRUE )

extract_brp_tr1 = raster::extract(brp_tr1_f09, brp_tr1_pt, buffer=1, fun=mean, df=TRUE )

extract_brp_tr2 = raster::extract(brp_tr2_f12, brp_tr2_pt, buffer=1, fun=mean,  df=TRUE )


extract_cn_tr1 = raster::extract(cn_tr1_f15, cn_tr1_pt, buffer=1, fun=mean,  df=TRUE )
extract_cn_tr2 = raster::extract(cn_tr2_f17, cn_tr2_pt, buffer=1, fun=mean,  df=TRUE )
```


```{r}
extract_alnus_tr1$plot_id = alnus_tr1_pt$ID
names(extract_alnus_tr1) = c('ID', 'mean_gcc', 'plot_id')
extract_alnus_tr1
```

```{r}
extract_ans_tr2$plot_id = ans_tr2_pt$ID
names(extract_ans_tr2) = c('ID', 'mean_gcc', 'plot_id')
extract_ans_tr2
```

```{r}
extract_ans_tr3$plot_id = ans_tr3_pt$ID
names(extract_ans_tr3) = c('ID', 'mean_gcc', 'plot_id')
extract_ans_tr3
```


```{r}
extract_brp_tr1$plot_id = brp_tr1_pt$ID
names(extract_brp_tr1) = c('ID', 'mean_gcc', 'plot_id')
extract_brp_tr1
```

```{r}
extract_brp_tr2$plot_id = brp_tr2_pt$ID
names(extract_brp_tr2) = c('ID', 'mean_gcc', 'plot_id')
extract_brp_tr2
```

```{r}
extract_cn_tr1$plot_id = cn_tr1_pt$ID
names(extract_cn_tr1) = c('ID', 'mean_gcc', 'plot_id')
extract_cn_tr1
```

```{r}
extract_cn_tr2$plot_id = cn_tr2_pt$ID
names(extract_cn_tr2) = c('ID', 'mean_gcc', 'plot_id')
extract_cn_tr2
```
extract_alnus_tr1, extract_ans_tr2, extract_ans_tr3, extract_brp_tr1, extract_brp_tr2, extract_cn_tr1, extract_cn_tr2
```{r}
ans_bind = rbind(extract_ans_tr2, extract_ans_tr3)
brp_bind = rbind( extract_brp_tr1, extract_brp_tr2)
cn_bind = rbind(extract_cn_tr1, extract_cn_tr2)
alnus_ans = rbind(extract_alnus_tr1, ans_bind)
brp_cn = rbind(brp_bind, cn_bind)
gcc_1m = rbind(alnus_ans, brp_cn)
gcc_1m
```

```{r}
write.csv(gcc_1m,"../outputs/extracted_data/gcc_1m.csv", row.names = FALSE)
```

