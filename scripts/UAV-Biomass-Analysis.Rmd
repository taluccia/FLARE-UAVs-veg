---
title: "UAV-Biomass-Analysis"
author: "Anna Talucci"
date: "5/13/2020"
output: html_document
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Overview


# Pakcages
```{r}
library(tidyr)
library(dplyr)
library(ggplot2)
library(stringr)
library(lme4)
library(cowplot)
library(lme4)
library(lsmeans)
library(DHARMa)
library(rcompanion)
library(qpcR)
```

# Functions

```{r}
numextract <- function(string){ 
  str_extract(string, "\\-*\\d+\\.*\\d*")
} 

```

# Field Data
```{r}
field_data = read.csv("../data/field_subset/field_data_all.csv")
```

```{r}
head(field_data)
```

## field Plot sizes

```{r}
field_data %>% group_by(site, transect) %>% 
  summarise(min(shrub_plot_area))
```

```{r}
field_data %>% group_by(site, transect) %>% 
  summarise(max(shrub_plot_area))
```

```{r}
field_data %>% group_by(site, transect) %>% 
  summarise(min(tree_radius))
```

```{r}
field_data %>% group_by(site, transect) %>% 
  summarise(max(tree_radius))
```

# UAV Data

```{r}
gcc_all = read.csv("../data/extracted_data/gcc_all.csv", strip.white = TRUE)
ndvi_all = read.csv("../data/extracted_data/2020-08-10_ndvi_all_pix4D.csv", strip.white = TRUE)
```

```{r}
head(gcc_all)
head(ndvi_all)
```
# Pull out GCC and NDVI by buffer size

```{r}
gcc_long = gcc_all %>% 
  dplyr::select(ID:mean_gcc_10m) %>%
  pivot_longer(-ID, names_to = "buffer", values_to = "gcc") %>%
  mutate(buf_res = numextract(buffer))

gcc_long
```

```{r}
ndvi_long = ndvi_all %>% 
  dplyr::select(ID:mean_ndvi_10m) %>%
  pivot_longer(-ID, names_to = "buffer", values_to = "ndvi") %>%
  mutate(buf_res = numextract(buffer))

ndvi_long
```

# Combine Field and UAV data

```{r}
gcc_ndvi = merge(gcc_all, ndvi_all, by="ID")
gcc_ndvi
field_gcc = merge(field_data, gcc_all, by="ID") 
field_gcc
field_gcc_ndvi = merge(field_data, gcc_ndvi,  "ID")
field_gcc_ndvi
```
# Field data +  long data
```{r}
field_gcc_long = merge(field_data, gcc_long, by="ID")

field_gcc_long
```

```{r}
field_ndvi_long = merge(field_data, ndvi_long, by="ID")

field_ndvi_long
```

# Variables as factor

```{r}
field_gcc$burn_year = as.factor(field_gcc$burn_year)
field_gcc_ndvi$burn_year = as.factor(field_gcc_ndvi$burn_year)

str(field_gcc)
str(field_gcc_ndvi)
```

```{r}
field_gcc_long$burn_year = as.factor(field_gcc_long$burn_year)
field_ndvi_long$burn_year= as.factor(field_ndvi_long$burn_year)
field_gcc_long$buf_res = as.factor(field_gcc_long$buf_res)
field_ndvi_long$buf_res = as.factor(field_ndvi_long$buf_res)
```



# Define graph Theme and color Palette 

```{r}
comp_theme = theme_bw() + theme(legend.position = "none") +  
  theme(panel.grid.major = element_blank()) +
    theme(axis.title.y = element_text(size = 11, hjust = 0.5, vjust = 1.1),
        axis.text.x = element_text(size = 10, color = "black"),
        axis.text.y = element_text(size = 10, color = "black"),
        axis.line = element_line(colour = "black"))
```
theme(panel.grid = element_blank(),
        panel.border = element_blank())
```{r}

reg_theme = theme_bw() + theme(legend.position = "none") +
  theme(plot.margin = unit(c(t = 0.3, r = 0.3, b = 0.3, l = 0.1), "cm")) +
  theme(axis.title.x = element_text(size = 10, hjust = 0.5, vjust = -0.2),
        axis.title.y = element_text(size = 10, hjust = 0.5, vjust = 1.1),
        axis.text.x = element_text(size = 9, color = "black"),
        axis.text.y = element_text(size = 9, color = "black"),
        panel.background = element_blank(), 
        axis.line = element_line(colour = "black"))

```

```{r}

blank_xy_theme = theme_bw() + theme(legend.position = "none") +
  theme(plot.margin = unit(c(t = 0.1, r = 0.1, b = 0.6, l = 0.6), "cm")) +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        panel.background = element_blank(), 
        axis.line = element_line(colour = "black"))


```

 
```{r}

blank_x_theme = theme_bw() + theme(legend.position = "none") +
  theme(plot.margin = unit(c(t = 0.3, r = 0.3, b = 0.3, l = 0.1), "cm")) +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_text(size = 11, hjust = 0.5, vjust = 1.1),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 10, color = "black"),
        panel.background = element_blank(), 
        axis.line = element_line(colour = "black"))

```

 
```{r}

blank_y_theme = theme_bw() + theme(legend.position = "none") +
  theme(plot.margin = unit(c(t = 0.3, r = 0.3, b = 0.3, l = 0.1), "cm")) +
  theme(axis.title.x = element_text(size = 11, hjust = 0.5, vjust = -0.1),
        axis.title.y = element_blank(),
        axis.text.x = element_text(size = 10, color = "black"),
        axis.text.y = element_blank(),
        panel.background = element_blank(), 
        axis.line = element_line(colour = "black"))

```

```{r}
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
```

```{r}
min(field_gcc$woody_biomass_C_g_m)
max(field_gcc$woody_biomass_C_g_m)

```

```{r}
min(field_gcc$live_woody_biomass_C_g_m)
max(field_gcc$live_woody_biomass_C_g_m)

```

# Analysis: 
```{r}
head(field_gcc)
```
```{r}
head(field_gcc_long)
```
# Part 4: Biomass as it relates to GCC and NDVI

#Model GCC

```{r}
model1 = lm(live_woody_biomass_C_g_m ~ gcc:buf_res, data = field_gcc_long)
```

```{r}
summary(model1)
```

## GCC

### 1. Model: Woody Biomass function of GCC 25 cm
woody_biomass_C_g_m
live_woody_biomass_C_g_m
```{r}
fit1 = lm(live_woody_biomass_C_g_m ~ mean_gcc_25cm, data = field_gcc)
```

#### lm summary
```{r}
summary(fit1)
```
```{r}
str(summary(fit1)) 
```
```{r}
fit1_df = data.frame(summary(fit1)$coefficients[,], confint(fit1), extractAIC(fit1))
fit1_df
fit1_df2 = tibble::rownames_to_column(fit1_df, "coefficent")
fit1_df3 = fit1_df2 %>% 
  mutate(model = "fit1") %>% 
  mutate(response = "GCC_25cm" ) %>%  
  mutate(rmse = RMSE(fit1)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., AIC = extractAIC.fit1.) %>% dplyr::select(model:response, coefficent:rmse)
fit1_df3
```

#### lm Graph

```{r}
p1 = ggplot(data = field_gcc, aes(x = live_woody_biomass_C_g_m, y = mean_gcc_25cm)) + 
    geom_point(size = 2) +  
  stat_smooth(method = "lm", col = "black", alpha = .25) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme + 
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05), name = "GCC (25cm)")
p1
  
```

### glm

```{r}
mod1 = glm(mean_gcc_25cm ~ live_woody_biomass_C_g_m, data = field_gcc, family = gaussian)
```


#### Residuals with DHARMa
```{r, include=FALSE}
mod1.res = simulateResiduals(fittedModel = mod1, n = 500)
mod1.res$scaledResiduals
mod1.res$scaledResidualsNormal
```

In the plot below we are looking for the points in the QQ plot to fall along the RED linen. In the Residuals vs.predicted plot were are looking for the lines to be relatively horizontal. All looks good. 
```{r}
plotSimulatedResiduals(simulationOutput = mod1.res)
```

```{r}
testDispersion(mod1.res)
```

#### summary
```{r}
summary(mod1)
```
##### Summary Dataframe

```{r}
mod1_df = data.frame(summary(mod1)$coefficients[,], confint(mod1), deviance(mod1), summary(mod1)$null.deviance, extractAIC(mod1))
mod1_df
mod1_df2 = tibble::rownames_to_column(mod1_df, "coefficent")
mod1_df2
mod1_df3 = mod1_df2 %>% 
  mutate(model = "mod1") %>% 
  mutate(response = "GCC" ) %>% 
  mutate(resolution = "25cm" ) %>% 
  mutate(rmse = RMSE(mod1)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., deviance=deviance.mod1., null_deviance= summary.mod1..null.deviance, AIC = extractAIC.mod1.) %>% 
  dplyr::select(model, response, resolution, coefficent:rmse)
mod1_df3
```

#### Data for graph

```{r}
preddat_mod1 = data.frame(live_woody_biomass_C_g_m = field_gcc$live_woody_biomass_C_g_m)

head(preddat_mod1)

pred_mod1 = predict(mod1, newdata = preddat_mod1, se.fit = TRUE)

UL_mod1 = with(pred_mod1, fit + 2*se.fit)
LL_mod1 = with(pred_mod1, fit - 2*se.fit)

field_gcc1 = mutate(field_gcc, pred_mod1 = pred_mod1$fit, 
               ucl_mod1 = UL_mod1, 
               lcl_mod1 = LL_mod1)
```

#### Graph 
##### No labels
```{r}
plot_mod1 = ggplot(data = field_gcc1, aes(x = live_woody_biomass_C_g_m, y = mean_gcc_25cm)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod1), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod1, ymax = ucl_mod1, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod1), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod1), linetype='longdash', size = 1) +

    blank_xy_theme +  guides(color=guide_legend(override.aes=list(fill=NA))) +
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05), labels = c("0.3", "", "0.4", ""),name = "")

plot_mod1
```
##### labels
```{r}
plot1 = ggplot(data = field_gcc1, aes(x = live_woody_biomass_C_g_m, y = mean_gcc_25cm)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod1), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod1, ymax = ucl_mod1, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod1), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod1), linetype='longdash', size = 1) +
    
  labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme +
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05), name = "GCC (25cm)")

plot1
```

### 2. Model: GCC Biomass 50cm
```{r}
fit2 = lm(live_woody_biomass_C_g_m ~ mean_gcc_50cm, data = field_gcc)
```

#### lm summary
```{r}
summary(fit2)
```

```{r}
fit2_df = data.frame(summary(fit2)$coefficients[,], confint(fit2), extractAIC(fit2))
fit2_df
fit2_df2 = tibble::rownames_to_column(fit2_df, "coefficent")
fit2_df3 = fit2_df2 %>% 
  mutate(model = "fit2") %>% 
  mutate(response = "GCC_50cm" ) %>%  
  mutate(rmse = RMSE(fit2)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., AIC = extractAIC.fit2.) %>% dplyr::select(model:response, coefficent:rmse)
fit2_df3
```

#### lm Graph

```{r}
p2 = ggplot(data = field_gcc, aes(x = live_woody_biomass_C_g_m, y = mean_gcc_50cm)) + 
    geom_point(size = 2) +  
  stat_smooth(method = "lm", col = "black", alpha = .25) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme + 
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05), name  = "GCC (50cm)")
p2
  
```

### glm

```{r}
mod2 = glm(mean_gcc_50cm ~ live_woody_biomass_C_g_m, data = field_gcc, family = gaussian)
```


#### Residuals with DHARMa
```{r, include=FALSE}
mod2.res = simulateResiduals(fittedModel = mod2, n = 500)
mod2.res$scaledResiduals
mod2.res$scaledResidualsNormal
```

In the plot below we are looking for the points in the QQ plot to fall along the RED linen. In the Residuals vs.predicted plot were are looking for the lines to be relatively horizontal. All looks good. 
```{r}
plotSimulatedResiduals(simulationOutput = mod2.res)
```

```{r}
testDispersion(mod2.res)
```

#### summary
```{r}
summary(mod2)
```
##### Summary Dataframe

```{r}
mod2_df = data.frame(summary(mod2)$coefficients[,], confint(mod2), deviance(mod2), summary(mod2)$null.deviance, extractAIC(mod2))
mod2_df
mod2_df2 = tibble::rownames_to_column(mod2_df, "coefficent")
mod2_df3 = mod2_df2 %>% 
  mutate(model = "mod2") %>% 
  mutate(response = "GCC" ) %>% 
  mutate(resolution = "50cm" ) %>% 
  mutate(rmse = RMSE(mod2)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., deviance=deviance.mod2., null_deviance= summary.mod2..null.deviance, AIC = extractAIC.mod2.) %>% 
  dplyr::select(model, response,  resolution, coefficent:rmse)
mod2_df3
```

#### Data for graph
```{r}
preddat_mod2 = data.frame(live_woody_biomass_C_g_m = field_gcc$live_woody_biomass_C_g_m)

head(preddat_mod2)

pred_mod2 = predict(mod2, newdata = preddat_mod2, se.fit = TRUE)

UL_mod2 = with(pred_mod2, fit + 2*se.fit)
LL_mod2 = with(pred_mod2, fit - 2*se.fit)

field_gcc2 = mutate(field_gcc, pred_mod2 = pred_mod2$fit, 
               ucl_mod2 = UL_mod2, 
               lcl_mod2 = LL_mod2)
```

#### Graph 
##### no labels
```{r}
plot_mod2 = ggplot(data = field_gcc2, aes(x = live_woody_biomass_C_g_m, y = mean_gcc_50cm)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod2), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod2, ymax = ucl_mod2, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod2), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod2), linetype='longdash', size = 1) +
    
    blank_xy_theme +  guides(color=guide_legend(override.aes=list(fill=NA))) +
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05), labels = c("0.3", "", "0.4", ""),  name = "")

plot_mod2
```
##### Labels
```{r}
plot2 = ggplot(data = field_gcc2, aes(x = live_woody_biomass_C_g_m, y = mean_gcc_50cm)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod2), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod2, ymax = ucl_mod2, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod2), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod2), linetype='longdash', size = 1) +
   labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme +  
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05), name  = "GCC (50cm)")

plot2
```

```{r}
fig2 = ggplot(data = field_gcc2, aes(x = live_woody_biomass_C_g_m, y = mean_gcc_50cm)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod2), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod2, ymax = ucl_mod2, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod2), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod2), linetype='longdash', size = 1) +
    xlab("Biomass") +
    reg_theme +  
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05), labels = c("0.3", "", "0.4", ""),  name = "GCC (50cm)")

fig2
```

### 3. Model: GCC Biomass 1m

```{r}
fit3 = lm(live_woody_biomass_C_g_m ~ mean_gcc_1m, data = field_gcc)
```

#### lm summary
```{r}
summary(fit3)
```

```{r}
fit3_df = data.frame(summary(fit3)$coefficients[,], confint(fit3), extractAIC(fit3))
fit3_df
fit3_df2 = tibble::rownames_to_column(fit3_df, "coefficent")
fit3_df3 = fit3_df2 %>% 
  mutate(model = "fit3") %>% 
  mutate(response = "GCC_1m" ) %>%  
  mutate(rmse = RMSE(fit3)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., AIC = extractAIC.fit3.) %>% dplyr::select(model:response, coefficent:rmse)
fit3_df3
```

#### lm Graph

```{r}
p3 = ggplot(data = field_gcc, aes(x = live_woody_biomass_C_g_m, y = mean_gcc_1m)) + 
    geom_point(size = 2) +  
  stat_smooth(method = "lm", col = "black", alpha = .25) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme + 
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05), name = "GCC (1m)")
p3
  
```


### glm
```{r}
mod3 = glm(mean_gcc_1m ~ live_woody_biomass_C_g_m, data = field_gcc, family = gaussian)
```

#### Residuals with DHARMa
```{r, include=FALSE}
mod3.res = simulateResiduals(fittedModel = mod3, n = 500)
mod3.res$scaledResiduals
mod3.res$scaledResidualsNormal
```

In the plot below we are looking for the points in the QQ plot to fall along the RED linen. In the Residuals vs.predicted plot were are looking for the lines to be relatively horizontal. All looks good. 
```{r}
plotSimulatedResiduals(simulationOutput = mod3.res)
```

```{r}
testDispersion(mod3.res)
```

#### summary
```{r}
summary(mod3)
```
##### Summary Dataframe

```{r}
mod3_df = data.frame(summary(mod3)$coefficients[,], confint(mod3), deviance(mod3), summary(mod3)$null.deviance, extractAIC(mod3))
mod3_df
mod3_df2 = tibble::rownames_to_column(mod3_df, "coefficent")
mod3_df3 = mod3_df2 %>% 
  mutate(model = "mod3") %>% 
  mutate(response = "GCC" ) %>% 
  mutate(resolution = "1m" ) %>%
  mutate(rmse = RMSE(mod3)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., deviance=deviance.mod3., null_deviance= summary.mod3..null.deviance, AIC = extractAIC.mod3.) %>% 
  dplyr::select(model, response, resolution, coefficent:rmse)
mod3_df3
```

#### Data for graph
```{r}
preddat_mod3 = data.frame(live_woody_biomass_C_g_m = field_gcc$live_woody_biomass_C_g_m)

head(preddat_mod3)

pred_mod3 = predict(mod3, newdata = preddat_mod3, se.fit = TRUE)

UL_mod3 = with(pred_mod3, fit + 2*se.fit)
LL_mod3 = with(pred_mod3, fit - 2*se.fit)

field_gcc3 = mutate(field_gcc, pred_mod3 = pred_mod3$fit, 
               ucl_mod3 = UL_mod3, 
               lcl_mod3 = LL_mod3)
```

#### Graph 
##### No labels
```{r}
plot_mod3 = ggplot(data = field_gcc3, aes(x = live_woody_biomass_C_g_m, y = mean_gcc_1m)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod3), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod3, ymax = ucl_mod3, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod3), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod3), linetype='longdash', size = 1) +

    blank_xy_theme +  guides(color=guide_legend(override.aes=list(fill=NA))) +
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05), labels = c("0.3", "", "0.4", ""), name = "")

plot_mod3
```
##### labels
```{r}
plot3 = ggplot(data = field_gcc3, aes(x = live_woody_biomass_C_g_m, y = mean_gcc_1m)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod3), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod3, ymax = ucl_mod3, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod3), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod3), linetype='longdash', size = 1) +
   reg_theme +  labs(x=expression(C~mass~(g~C~m^-2))) +
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05), name = "GCC (1m)")

plot3
```


### 4. Model: GCC Biomass 3m
```{r}
fit4 = lm(live_woody_biomass_C_g_m ~ mean_gcc_3m, data = field_gcc)
```

#### lm summary
```{r}
summary(fit4)
```

```{r}
fit4_df = data.frame(summary(fit4)$coefficients[,], confint(fit4), extractAIC(fit4))
fit4_df
fit4_df2 = tibble::rownames_to_column(fit4_df, "coefficent")
fit4_df3 = fit4_df2 %>% 
  mutate(model = "fit4") %>% 
  mutate(response = "GCC_3m" ) %>%  
  mutate(rmse = RMSE(fit4)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., AIC = extractAIC.fit4.) %>% dplyr::select(model:response, coefficent:rmse)
fit4_df3
```

#### lm Graph

```{r}
p4 = ggplot(data = field_gcc, aes(x = live_woody_biomass_C_g_m, y = mean_gcc_3m)) + 
    geom_point(size = 2) +  
  stat_smooth(method = "lm", col = "black", alpha = .25) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme + 
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1),name = "GCC (3m)")
p4
  
```

### glm
```{r}
mod4 = glm(mean_gcc_3m ~ live_woody_biomass_C_g_m, data = field_gcc, family = gaussian)
```



#### Residuals with DHARMa
```{r, include=FALSE}
mod4.res = simulateResiduals(fittedModel = mod4, n = 500)
mod4.res$scaledResiduals
mod4.res$scaledResidualsNormal
```

In the plot below we are looking for the points in the QQ plot to fall along the RED linen. In the Residuals vs.predicted plot were are looking for the lines to be relatively horizontal. All looks good. 
```{r}
plotSimulatedResiduals(simulationOutput = mod4.res)
```

```{r}
testDispersion(mod4.res)
```

#### summary
```{r}
summary(mod4)
```
##### Summary Dataframe

```{r}
mod4_df = data.frame(summary(mod4)$coefficients[,], confint(mod4), deviance(mod4), summary(mod4)$null.deviance, extractAIC(mod4))
mod4_df
mod4_df2 = tibble::rownames_to_column(mod4_df, "coefficent")
mod4_df3 = mod4_df2 %>% 
  mutate(model = "mod4") %>% 
  mutate(response = "GCC" ) %>% 
  mutate(resolution = "3m" ) %>%
  mutate(rmse = RMSE(mod4)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., deviance=deviance.mod4., null_deviance= summary.mod4..null.deviance, AIC = extractAIC.mod4.) %>% 
  dplyr::select(model, response, resolution, coefficent:rmse)
mod4_df3
```

#### Data for graph
```{r}
preddat_mod4 = data.frame(live_woody_biomass_C_g_m = field_gcc$live_woody_biomass_C_g_m)

head(preddat_mod4)

pred_mod4 = predict(mod4, newdata = preddat_mod4, se.fit = TRUE)

UL_mod4 = with(pred_mod4, fit + 2*se.fit)
LL_mod4 = with(pred_mod4, fit - 2*se.fit)

field_gcc4 = mutate(field_gcc, pred_mod4 = pred_mod4$fit, 
               ucl_mod4 = UL_mod4, 
               lcl_mod4 = LL_mod4)
```

#### Graph 
##### No labels
```{r}
plot_mod4 = ggplot(data = field_gcc4, aes(x = live_woody_biomass_C_g_m, y = mean_gcc_3m)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod4), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod4, ymax = ucl_mod4, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod4), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod4), linetype='longdash', size = 1) +

    blank_xy_theme +  
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05),labels = c("0.3", "0.35", "0.4", ""), name = "")

plot_mod4
```
##### labels
```{r}
plot4 = ggplot(data = field_gcc4, aes(x = live_woody_biomass_C_g_m, y = mean_gcc_3m)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod4), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod4, ymax = ucl_mod4, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod4), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod4), linetype='longdash', size = 1) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
   reg_theme +  
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05), name="GCC (3m)")

plot4
```

### 5. Model: GCC Biomass 5m
```{r}
fit5 = lm(live_woody_biomass_C_g_m ~ mean_gcc_5m, data = field_gcc)
```


#### lm summary
```{r}
summary(fit5)
```

```{r}
fit5_df = data.frame(summary(fit5)$coefficients[,], confint(fit5), extractAIC(fit5))
fit5_df
fit5_df2 = tibble::rownames_to_column(fit5_df, "coefficent")
fit5_df3 = fit5_df2 %>% 
  mutate(model = "fit5") %>% 
  mutate(response = "GCC_5m" ) %>%  
  mutate(rmse = RMSE(fit5)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., AIC = extractAIC.fit5.) %>% dplyr::select(model:response, coefficent:rmse)
fit5_df3
```

#### lm Graph

```{r}
p5 = ggplot(data = field_gcc, aes(x = live_woody_biomass_C_g_m, y = mean_gcc_5m)) + 
    geom_point(size = 2) +  
  stat_smooth(method = "lm", col = "black", alpha = .25) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme + 
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05),  name = "GCC (5m)")
p5
  
```

###glm

```{r}
mod5 = glm(mean_gcc_5m ~ live_woody_biomass_C_g_m, data = field_gcc, family = gaussian)
```

#### Residuals with DHARMa
```{r, include=FALSE}
mod5.res = simulateResiduals(fittedModel = mod5, n = 500)
mod5.res$scaledResiduals
mod5.res$scaledResidualsNormal
```

In the plot below we are looking for the points in the QQ plot to fall along the RED linen. In the Residuals vs.predicted plot were are looking for the lines to be relatively horizontal. All looks good. 
```{r}
plotSimulatedResiduals(simulationOutput = mod5.res)
```

```{r}
testDispersion(mod5.res)
```

#### summary
```{r}
summary(mod5)
```

##### Summary Dataframe

```{r}
mod5_df = data.frame(summary(mod5)$coefficients[,], confint(mod5), deviance(mod5), summary(mod5)$null.deviance, extractAIC(mod5))
mod5_df
mod5_df2 = tibble::rownames_to_column(mod5_df, "coefficent")
mod5_df3 = mod5_df2 %>% 
  mutate(model = "mod5") %>% 
  mutate(response = "GCC" ) %>% 
  mutate(resolution = "5m" ) %>%
  mutate(rmse = RMSE(mod5)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., deviance=deviance.mod5., null_deviance= summary.mod5..null.deviance, AIC = extractAIC.mod5.) %>% 
  dplyr::select(model, response, resolution, coefficent:rmse)
mod5_df3
```

#### Data for graph
```{r}
preddat_mod5 = data.frame(live_woody_biomass_C_g_m = field_gcc$live_woody_biomass_C_g_m)

head(preddat_mod5)

pred_mod5 = predict(mod5, newdata = preddat_mod5, se.fit = TRUE)

UL_mod5 = with(pred_mod5, fit + 2*se.fit)
LL_mod5 = with(pred_mod5, fit - 2*se.fit)

field_gcc5 = mutate(field_gcc, pred_mod5 = pred_mod5$fit, 
               ucl_mod5 = UL_mod5, 
               lcl_mod5 = LL_mod5)
```

#### Graph 
##### No labels
```{r}
plot_mod5 = ggplot(data = field_gcc5, aes(x =live_woody_biomass_C_g_m, y = mean_gcc_5m)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod5), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod5, ymax = ucl_mod5, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod5), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod5), linetype='longdash', size = 1) +

    blank_xy_theme +  
  guides(color=guide_legend(override.aes=list(fill=NA))) +
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05), labels = c("0.3", "0.35", "0.4", ""),  name="")

plot_mod5
```
##### labels
```{r}
plot5 = ggplot(data = field_gcc5, aes(x =live_woody_biomass_C_g_m, y = mean_gcc_5m)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod5), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod5, ymax = ucl_mod5, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod5), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod5), linetype='longdash', size = 1) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme +  
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05),  name = "GCC (5m)")
plot5
```

### 6. Model: GCC Biomass 10m
```{r}
fit6 = lm(live_woody_biomass_C_g_m ~ mean_gcc_10m, data = field_gcc)
```

#### lm summary
```{r}
summary(fit6)
```

```{r}
fit6_df = data.frame(summary(fit6)$coefficients[,], confint(fit6), extractAIC(fit6))
fit6_df
fit6_df2 = tibble::rownames_to_column(fit6_df, "coefficent")
fit6_df3 = fit6_df2 %>% 
  mutate(model = "fit6") %>% 
  mutate(response = "GCC_10m" ) %>%  
  mutate(rmse = RMSE(fit6)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., AIC = extractAIC.fit6.) %>% dplyr::select(model:response, coefficent:rmse)
fit6_df3
```

#### lm Graph

```{r}
p6 = ggplot(data = field_gcc, aes(x = live_woody_biomass_C_g_m, y = mean_gcc_10m)) + 
    geom_point(size = 2) +  
  stat_smooth(method = "lm", col = "black", alpha = .25) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme + 
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05), name = "GCC (10m)")
p6
  
```

### glm
```{r}
mod6 = glm(mean_gcc_10m ~ live_woody_biomass_C_g_m, data = field_gcc, family = gaussian)
```

#### Residuals with DHARMa
```{r, include=FALSE}
mod6.res = simulateResiduals(fittedModel = mod6, n = 500)
mod6.res$scaledResiduals
mod6.res$scaledResidualsNormal
```

In the plot below we are looking for the points in the QQ plot to fall along the RED linen. In the Residuals vs.predicted plot were are looking for the lines to be relatively horizontal. All looks good. 
```{r}
plotSimulatedResiduals(simulationOutput = mod6.res)
```

```{r}
testDispersion(mod6.res)
```

#### summary
```{r}
summary(mod6)
```
##### Summary Dataframe

```{r}
mod6_df = data.frame(summary(mod6)$coefficients[,], confint(mod6), deviance(mod6), summary(mod6)$null.deviance, extractAIC(mod6))
mod6_df
mod6_df2 = tibble::rownames_to_column(mod6_df, "coefficent")
mod6_df3 = mod6_df2 %>% 
  mutate(model = "mod6") %>% 
  mutate(response = "GCC" ) %>% 
  mutate(resolution = "10m" ) %>%
  mutate(rmse = RMSE(mod6)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., deviance=deviance.mod6., null_deviance= summary.mod6..null.deviance, AIC = extractAIC.mod6.) %>% 
  dplyr::select(model, response,resolution, coefficent:rmse)
mod6_df3
```

#### Data for graph

```{r}
preddat_mod6 = data.frame(live_woody_biomass_C_g_m = field_gcc$live_woody_biomass_C_g_m)

head(preddat_mod6)

pred_mod6 = predict(mod6, newdata = preddat_mod6, se.fit = TRUE)

UL_mod6 = with(pred_mod6, fit + 2*se.fit)
LL_mod6 = with(pred_mod6, fit - 2*se.fit)

field_gcc6 = mutate(field_gcc, pred_mod6 = pred_mod6$fit, 
               ucl_mod6 = UL_mod6, 
               lcl_mod6 = LL_mod6)
```

#### Graph 
##### No labels
```{r}
plot_mod6 = ggplot(data = field_gcc6, aes(x = live_woody_biomass_C_g_m, y = mean_gcc_10m)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod6), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod6, ymax = ucl_mod6, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod6), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod6), linetype='longdash', size = 1) +

    blank_xy_theme +  
  guides(color=guide_legend(override.aes=list(fill=NA))) +
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05), labels = c("0.3", "", "0.4", ""), name = "", expand = c(0,0))

plot_mod6
```

##### labels
```{r}
plot6 = ggplot(data = field_gcc6, aes(x = live_woody_biomass_C_g_m, y = mean_gcc_10m)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod6), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod6, ymax = ucl_mod6, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod6), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod6), linetype='longdash', size = 1) +
   labs(x=expression(C~mass~(g~C~m^-2))) +
  reg_theme +  
  scale_y_continuous(breaks = seq(0.3, 0.45, by = .05), name = "GCC (10m)")

plot6
```

```{r}
compareGLM(mod1, mod2, mod3, mod4, mod5, mod6)
```


## NDVI

### 7. Model: NDVI Biomass 25cm
```{r}
fit7 = lm(live_woody_biomass_C_g_m ~ mean_ndvi_25cm, data = field_gcc_ndvi)
```

#### lm summary
```{r}
summary(fit7)
```

```{r}
fit7_df = data.frame(summary(fit7)$coefficients[,], confint(fit7), extractAIC(fit7))
fit7_df
fit7_df2 = tibble::rownames_to_column(fit7_df, "coefficent")
fit7_df3 = fit7_df2 %>% 
  mutate(model = "fit7") %>% 
  mutate(response = "NDVI_25cm" ) %>%  
  mutate(rmse = RMSE(fit7)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., AIC = extractAIC.fit7.) %>% dplyr::select(model:response, coefficent:rmse)
fit7_df3
```

#### lm Graph

```{r}
p7 = ggplot(data = field_gcc_ndvi, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_25cm)) + 
    geom_point(size = 2) +  
  stat_smooth(method = "lm", col = "black", alpha = .25) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme + 
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1), name = "NDVI (25cm)")
p7
  
```

### glm
```{r}
mod7 = glm(mean_ndvi_25cm ~ live_woody_biomass_C_g_m, data = field_gcc_ndvi, family = gaussian)
```

#### Residuals with DHARMa
```{r, include=FALSE}
mod7.res = simulateResiduals(fittedModel = mod7, n = 500)
mod7.res$scaledResiduals
mod7.res$scaledResidualsNormal
```

In the plot below we are looking for the points in the QQ plot to fall along the RED linen. In the Residuals vs.predicted plot were are looking for the lines to be relatively horizontal. All looks good. 
```{r}
plotSimulatedResiduals(simulationOutput = mod7.res)
```

```{r}
testDispersion(mod7.res)
```

#### summary
```{r}
summary(mod7)
```

##### Summary Dataframe

```{r}
mod7_df = data.frame(summary(mod7)$coefficients[,], confint(mod7), deviance(mod7), summary(mod7)$null.deviance, extractAIC(mod7))
mod7_df
mod7_df2 = tibble::rownames_to_column(mod7_df, "coefficent")
mod7_df3 = mod7_df2 %>% 
  mutate(model = "mod7") %>% 
  mutate(response = "NDVI" ) %>%  
  mutate(resolution = "25cm" ) %>%
  mutate(rmse = RMSE(mod7)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., deviance=deviance.mod7., null_deviance= summary.mod7..null.deviance, AIC = extractAIC.mod7.) %>% 
  dplyr::select(model, response, resolution, coefficent:rmse)
mod7_df3
```


#### Data for graph
```{r}
preddat_mod7 = data.frame(live_woody_biomass_C_g_m = field_gcc_ndvi$live_woody_biomass_C_g_m)

head(preddat_mod7)

pred_mod7 = predict(mod7, newdata = preddat_mod7, se.fit = TRUE)

UL_mod7 = with(pred_mod7, fit + 2*se.fit)
LL_mod7 = with(pred_mod7, fit - 2*se.fit)

field_gcc_ndvi7 = mutate(field_gcc_ndvi, pred_mod7 = pred_mod7$fit, 
               ucl_mod7 = UL_mod7, 
               lcl_mod7 = LL_mod7)
```

#### Graph 
##### No labels
```{r}
plot_mod7 = ggplot(data = field_gcc_ndvi7, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_25cm)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod7), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod7, ymax = ucl_mod7, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod7), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod7), linetype='longdash', size = 1) +
    
    ylab("Mean NDVI (25cm)") +
    xlab("Biomass")  +
    blank_xy_theme +  
  guides(color=guide_legend(override.aes=list(fill=NA))) +
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1), name = "")

plot_mod7
```
##### labels
```{r}
plot7 = ggplot(data = field_gcc_ndvi7, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_25cm)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod7), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod7, ymax = ucl_mod7, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod7), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod7), linetype='longdash', size = 1) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme +  
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1), name = "NDVI (25cm)")
plot7
```

### 8. Model: NDVI Biomass 50cm
```{r}
fit8 = lm(live_woody_biomass_C_g_m ~ mean_ndvi_50cm, data = field_gcc_ndvi)
```

#### lm summary
```{r}
summary(fit8)
```

```{r}
fit8_df = data.frame(summary(fit8)$coefficients[,], confint(fit8), extractAIC(fit8))
fit8_df
fit8_df2 = tibble::rownames_to_column(fit8_df, "coefficent")
fit8_df3 = fit8_df2 %>% 
  mutate(model = "fit8") %>% 
  mutate(response = "NDVI_50cm" ) %>%  
  mutate(rmse = RMSE(fit8)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., AIC = extractAIC.fit8.) %>% dplyr::select(model:response, coefficent:rmse)
fit8_df3
```

#### lm Graph

```{r}
p8 = ggplot(data = field_gcc_ndvi, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_50cm)) + 
    geom_point(size = 2) +  
  stat_smooth(method = "lm", col = "black", alpha = .25) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme + 
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1), name = "NDVI (50cm)")
p8
  
```

### glm

```{r}
mod8 = glm(mean_ndvi_50cm ~ live_woody_biomass_C_g_m, data = field_gcc_ndvi, family = gaussian)
```

#### Residuals with DHARMa
```{r, include=FALSE}
mod8.res = simulateResiduals(fittedModel = mod8, n = 500)
mod8.res$scaledResiduals
mod8.res$scaledResidualsNormal
```

In the plot below we are looking for the points in the QQ plot to fall along the RED linen. In the Residuals vs.predicted plot were are looking for the lines to be relatively horizontal. All looks good. 
```{r}
plotSimulatedResiduals(simulationOutput = mod8.res)
```

```{r}
testDispersion(mod8.res)
```

#### summary
```{r}
summary(mod8)
```
##### Summary Dataframe

```{r}
mod8_df = data.frame(summary(mod8)$coefficients[,], confint(mod8), deviance(mod8), summary(mod8)$null.deviance, extractAIC(mod8))
mod8_df
mod8_df2 = tibble::rownames_to_column(mod8_df, "coefficent")
mod8_df3 = mod8_df2 %>% 
  mutate(model = "mod8") %>% 
  mutate(response = "NDVI" ) %>% 
  mutate(resolution = "50cm" ) %>%
  mutate(rmse = RMSE(mod8)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., deviance=deviance.mod8., null_deviance= summary.mod8..null.deviance, AIC = extractAIC.mod8.) %>% 
  dplyr::select(model, response,resolution, coefficent:rmse)
mod8_df3
```

#### Data for graph
```{r}
preddat_mod8 = data.frame(live_woody_biomass_C_g_m = field_gcc_ndvi$live_woody_biomass_C_g_m)

head(preddat_mod8)

pred_mod8 = predict(mod8, newdata = preddat_mod8, se.fit = TRUE)

UL_mod8 = with(pred_mod8, fit + 2*se.fit)
LL_mod8 = with(pred_mod8, fit - 2*se.fit)

field_gcc_ndvi8 = mutate(field_gcc_ndvi, pred_mod8 = pred_mod8$fit, 
               ucl_mod8 = UL_mod8, 
               lcl_mod8 = LL_mod8)
```

#### Graph 
##### No labels
```{r}
plot_mod8 = ggplot(data = field_gcc_ndvi8, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_50cm)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod8), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod8, ymax = ucl_mod8, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod8), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod8), linetype='longdash', size = 1) +

    blank_xy_theme + 
  guides(color=guide_legend(override.aes=list(fill=NA))) +
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1), name = "") 

plot_mod8
```
##### labels
```{r}
plot8 = ggplot(data = field_gcc_ndvi8, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_50cm)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod8), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod8, ymax = ucl_mod8, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod8), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod8), linetype='longdash', size = 1) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme +  
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1), name = "NDVI (50cm)")

plot8
```

### 9. Model: NDVI Biomass 1m
```{r}
fit9 = lm(live_woody_biomass_C_g_m ~ mean_ndvi_1m, data = field_gcc_ndvi)
```

#### lm summary
```{r}
summary(fit9)
```

```{r}
fit9_df = data.frame(summary(fit9)$coefficients[,], confint(fit9), extractAIC(fit9))
fit9_df
fit9_df2 = tibble::rownames_to_column(fit9_df, "coefficent")
fit9_df3 = fit9_df2 %>% 
  mutate(model = "fit9") %>% 
  mutate(response = "NDVI_1m" ) %>%  
  mutate(rmse = RMSE(fit9)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., AIC = extractAIC.fit9.) %>% dplyr::select(model:response, coefficent:rmse)
fit9_df3
```

#### lm Graph

```{r}
p9 = ggplot(data = field_gcc_ndvi, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_1m)) + 
    geom_point(size = 2) +  
  stat_smooth(method = "lm", col = "black", alpha = .25) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme + 
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1), name = "NDVI (1m)")
p9
  
```

### glm
```{r}
mod9 = glm(mean_ndvi_1m ~ live_woody_biomass_C_g_m, data = field_gcc_ndvi, family = gaussian)
```

#### Residuals with DHARMa
```{r, include=FALSE}
mod9.res = simulateResiduals(fittedModel = mod9, n = 500)
mod9.res$scaledResiduals
mod9.res$scaledResidualsNormal
```

In the plot below we are looking for the points in the QQ plot to fall along the RED linen. In the Residuals vs.predicted plot were are looking for the lines to be relatively horizontal. All looks good. 
```{r}
plotSimulatedResiduals(simulationOutput = mod9.res)
```

```{r}
testDispersion(mod9.res)
```

#### summary
```{r}
summary(mod9)
```
##### Summary Dataframe

```{r}
mod9_df = data.frame(summary(mod9)$coefficients[,], confint(mod9), deviance(mod9), summary(mod9)$null.deviance, extractAIC(mod9))
mod9_df
mod9_df2 = tibble::rownames_to_column(mod9_df, "coefficent")
mod9_df3 = mod9_df2 %>% 
  mutate(model = "mod9") %>% 
  mutate(response = "NDVI" ) %>% 
  mutate(resolution = "1m" ) %>%
  mutate(rmse = RMSE(mod9)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., deviance=deviance.mod9., null_deviance= summary.mod9..null.deviance, AIC = extractAIC.mod9.) %>% 
  dplyr::select(model, response, resolution, coefficent:rmse)
mod9_df3
```

#### Data for graph
```{r}
preddat_mod9 = data.frame(live_woody_biomass_C_g_m = field_gcc_ndvi$live_woody_biomass_C_g_m)

head(preddat_mod9)

pred_mod9 = predict(mod9, newdata = preddat_mod9, se.fit = TRUE)

UL_mod9 = with(pred_mod9, fit + 2*se.fit)
LL_mod9 = with(pred_mod9, fit - 2*se.fit)

field_gcc_ndvi9 = mutate(field_gcc_ndvi, pred_mod9 = pred_mod9$fit, 
               ucl_mod9 = UL_mod9, 
               lcl_mod9 = LL_mod9)
```

#### Graph 
##### No labels
```{r}
plot_mod9 = ggplot(data = field_gcc_ndvi9, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_1m)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod9), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod9, ymax = ucl_mod9, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod9), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod9), linetype='longdash', size = 1) +

    blank_xy_theme +  
  guides(color=guide_legend(override.aes=list(fill=NA))) +
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1), name = "")

plot_mod9
```

##### labels
```{r}
plot9 = ggplot(data = field_gcc_ndvi9, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_1m)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod9), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod9, ymax = ucl_mod9, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod9), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod9), linetype='longdash', size = 1) +
   labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme +  
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1), name = "NDVI (1m)")

plot9
```

### 10. Model: NDVI Biomass 3m
```{r}
fit10 = lm(live_woody_biomass_C_g_m ~ mean_ndvi_3m, data = field_gcc_ndvi)
```

#### lm summary
```{r}
summary(fit10)
```

```{r}
fit10_df = data.frame(summary(fit10)$coefficients[,], confint(fit10), extractAIC(fit10))
fit10_df
fit10_df2 = tibble::rownames_to_column(fit10_df, "coefficent")
fit10_df3 = fit10_df2 %>% 
  mutate(model = "fit10") %>% 
  mutate(response = "NDVI_3m" ) %>%  
  mutate(rmse = RMSE(fit10)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., AIC = extractAIC.fit10.) %>% dplyr::select(model:response, coefficent:rmse)
fit10_df3
```

#### lm Graph

```{r}
p10 = ggplot(data = field_gcc_ndvi, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_3m)) + 
    geom_point(size = 2) +  
  stat_smooth(method = "lm", col = "black", alpha = .25) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme + 
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1),name = "NDVI (3m)")
p10
  
```

### glm
```{r}
mod10 = glm(mean_ndvi_3m ~ live_woody_biomass_C_g_m, data = field_gcc_ndvi, family = gaussian)
```

#### Residuals with DHARMa
```{r, include=FALSE}
mod10.res = simulateResiduals(fittedModel = mod10, n = 500)
mod10.res$scaledResiduals
mod10.res$scaledResidualsNormal
```

In the plot below we are looking for the points in the QQ plot to fall along the RED linen. In the Residuals vs.predicted plot were are looking for the lines to be relatively horizontal. All looks good. 
```{r}
plotSimulatedResiduals(simulationOutput = mod10.res)
```

```{r}
testDispersion(mod10.res)
```

#### Summary
```{r}
summary(mod10)
```


##### Summary Dataframe

```{r}
mod10_df = data.frame(summary(mod10)$coefficients[,], confint(mod10), deviance(mod10), summary(mod10)$null.deviance, extractAIC(mod10))
mod10_df
mod10_df2 = tibble::rownames_to_column(mod10_df, "coefficent")
mod10_df3 = mod10_df2 %>% 
  mutate(model = "mod10") %>% 
  mutate(response = "NDVI" ) %>%
  mutate(resolution = "3m" ) %>%
  mutate(rmse = RMSE(mod10)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., deviance=deviance.mod10., null_deviance= summary.mod10..null.deviance, AIC = extractAIC.mod10.) %>% 
  dplyr::select(model,response,resolution, coefficent:rmse)
mod10_df3
```

#### Data for graph
```{r}
preddat_mod10 = data.frame(live_woody_biomass_C_g_m = field_gcc_ndvi$live_woody_biomass_C_g_m)

head(preddat_mod10)

pred_mod10 = predict(mod10, newdata = preddat_mod10, se.fit = TRUE)

UL_mod10 = with(pred_mod10, fit + 2*se.fit)
LL_mod10 = with(pred_mod10, fit - 2*se.fit)

field_gcc_ndvi10 = mutate(field_gcc_ndvi, pred_mod10 = pred_mod10$fit, 
               ucl_mod10 = UL_mod10, 
               lcl_mod10 = LL_mod10)
```

#### Graph 
##### No labels
```{r}
plot_mod10 = ggplot(data = field_gcc_ndvi10, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_3m)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod10), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod10, ymax = ucl_mod10, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod10), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod10), linetype='longdash', size = 1) +

    blank_xy_theme +  
  guides(color=guide_legend(override.aes=list(fill=NA))) +
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1), name="") 

plot_mod10
```

##### labels
```{r}
plot10 = ggplot(data = field_gcc_ndvi10, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_3m)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod10), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod10, ymax = ucl_mod10, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod10), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod10), linetype='longdash', size = 1) +
      labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme +  
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1),name = "NDVI (3m)")

plot10
```

### 11. Model: NDVI Biomass 5m

```{r}
fit11 = lm(live_woody_biomass_C_g_m ~ mean_ndvi_5m, data = field_gcc_ndvi)
```

#### lm summary
```{r}
summary(fit11)
```

```{r}
fit11_df = data.frame(summary(fit11)$coefficients[,], confint(fit11), extractAIC(fit11))
fit11_df
fit11_df2 = tibble::rownames_to_column(fit11_df, "coefficent")
fit11_df3 = fit11_df2 %>% 
  mutate(model = "fit11") %>% 
  mutate(response = "NDVI_5m" ) %>%  
  mutate(rmse = RMSE(fit11)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., AIC = extractAIC.fit11.) %>% dplyr::select(model:response, coefficent:rmse)
fit11_df3
```

#### lm Graph

```{r}
p11 = ggplot(data = field_gcc_ndvi, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_5m)) + 
    geom_point(size = 2) +  
  stat_smooth(method = "lm", col = "black", alpha = .25) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme + 
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1), name = "NDVI (5m)")
p11
  
```

### Glm
```{r}
mod11 = glm(mean_ndvi_5m ~ live_woody_biomass_C_g_m, data = field_gcc_ndvi, family = gaussian)
```

#### Residuals with DHARMa
```{r, include=FALSE}
mod11.res = simulateResiduals(fittedModel = mod11, n = 500)
mod11.res$scaledResiduals
mod11.res$scaledResidualsNormal
```

In the plot below we are looking for the points in the QQ plot to fall along the RED linen. In the Residuals vs.predicted plot were are looking for the lines to be relatively horizontal. All looks good. 
```{r}
plotSimulatedResiduals(simulationOutput = mod11.res)
```

```{r}
testDispersion(mod11.res)
```

#### summary
```{r}
summary(mod11)
```
##### Summary Dataframe

```{r}
mod11_df = data.frame(summary(mod11)$coefficients[,], confint(mod11), deviance(mod11), summary(mod11)$null.deviance, extractAIC(mod11))
mod11_df
mod11_df2 = tibble::rownames_to_column(mod11_df, "coefficent")
mod11_df3 = mod11_df2 %>% 
  mutate(model = "mod11") %>% 
  mutate(response = "NDVI" ) %>% 
  mutate(resolution = "5m" ) %>%
  mutate(rmse = RMSE(mod11)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., deviance=deviance.mod11., null_deviance= summary.mod11..null.deviance, AIC = extractAIC.mod11.) %>% 
  dplyr::select(model, response, resolution, coefficent:rmse)
mod11_df3
```

#### Data for graph
```{r}
preddat_mod11 = data.frame(live_woody_biomass_C_g_m = field_gcc_ndvi$live_woody_biomass_C_g_m)

head(preddat_mod11)

pred_mod11 = predict(mod11, newdata = preddat_mod11, se.fit = TRUE)

UL_mod11 = with(pred_mod11, fit + 2*se.fit)
LL_mod11 = with(pred_mod11, fit - 2*se.fit)

field_gcc_ndvi11 = mutate(field_gcc_ndvi, pred_mod11 = pred_mod11$fit, 
               ucl_mod11 = UL_mod11, 
               lcl_mod11 = LL_mod11)
```

#### Graph 
##### No labels
```{r}
plot_mod11 = ggplot(data = field_gcc_ndvi11, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_5m)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod11), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod11, ymax = ucl_mod11, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod11), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod11), linetype='longdash', size = 1) +

    blank_xy_theme +  
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1), name="")

plot_mod11
```

##### labels
```{r}
plot11 = ggplot(data = field_gcc_ndvi11, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_5m)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod11), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod11, ymax = ucl_mod11, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod11), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod11), linetype='longdash', size = 1) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme + 
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1), name = "NDVI (5m)")

plot11
```

### 12. Model: NDVI Biomass 10m
```{r}
fit12 = lm(live_woody_biomass_C_g_m ~ mean_ndvi_10m, data = field_gcc_ndvi)
```


#### lm summary
```{r}
summary(fit12)
```

```{r}
fit12_df = data.frame(summary(fit12)$coefficients[,], confint(fit12), extractAIC(fit12))
fit12_df
fit12_df2 = tibble::rownames_to_column(fit12_df, "coefficent")
fit12_df3 = fit12_df2 %>% 
  mutate(model = "fit12") %>% 
  mutate(response = "NDVI_10m" ) %>%  
  mutate(rmse = RMSE(fit12)) %>%
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., AIC = extractAIC.fit12.) %>% dplyr::select(model:response, coefficent:rmse)
fit12_df3
```

#### lm Graph

```{r}
p12 = ggplot(data = field_gcc_ndvi, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_10m)) + 
    geom_point(size = 2) +  
  stat_smooth(method = "lm", col = "black", alpha = .25) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme + 
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1), name = "NDVI (10m)")
p12
  
```



```{r}
mod12 = glm(mean_ndvi_10m ~ live_woody_biomass_C_g_m, data = field_gcc_ndvi, family = gaussian)
```


#### Residuals with DHARMa
```{r, include=FALSE}
mod12.res = simulateResiduals(fittedModel = mod12, n = 500)
mod12.res$scaledResiduals
mod12.res$scaledResidualsNormal
```

In the plot below we are looking for the points in the QQ plot to fall along the RED linen. In the Residuals vs.predicted plot were are looking for the lines to be relatively horizontal. All looks good. 
```{r}
plotSimulatedResiduals(simulationOutput = mod12.res)
```

```{r}
testDispersion(mod12.res)
```

#### summary

```{r}
summary(mod12)
```

##### Summary Dataframe

```{r}
mod12_df = data.frame(summary(mod12)$coefficients[,], confint(mod12), deviance(mod12), summary(mod12)$null.deviance, extractAIC(mod12))
mod12_df
mod12_df2 = tibble::rownames_to_column(mod12_df, "coefficent")
mod12_df3 = mod12_df2 %>% 
  mutate(model = "mod12") %>% 
  mutate(response = "NDVI" ) %>% 
  mutate(resolution = "10m" ) %>%
  mutate(rmse = RMSE(mod12)) %>% 
  rename(estimate = Estimate, se = Std..Error, t_value = t.value,  p_value = Pr...t.., lcl = X2.5.., ucl = X97.5.., deviance=deviance.mod12., null_deviance= summary.mod12..null.deviance, AIC = extractAIC.mod12.) %>% 
  dplyr::select(model, response,  resolution, coefficent:rmse)
mod12_df3
```

#### Data for graph
```{r}
preddat_mod12 = data.frame(live_woody_biomass_C_g_m = field_gcc_ndvi$live_woody_biomass_C_g_m)

head(preddat_mod12)

pred_mod12 = predict(mod12, newdata = preddat_mod12, se.fit = TRUE)

UL_mod12 = with(pred_mod12, fit + 2*se.fit)
LL_mod12 = with(pred_mod12, fit - 2*se.fit)

field_gcc_ndvi12 = mutate(field_gcc_ndvi, pred_mod12 = pred_mod12$fit, 
               ucl_mod12 = UL_mod12, 
               lcl_mod12 = LL_mod12)
```

#### Graph 
##### No labels
```{r}
plot_mod12 = ggplot(data = field_gcc_ndvi12, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_10m)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod12), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod12, ymax = ucl_mod12, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod12), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod12), linetype='longdash', size = 1) +
  
    blank_xy_theme +  
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1), name = "")

plot_mod12
```
##### labels
```{r}
plot12 = ggplot(data = field_gcc_ndvi12, aes(x = live_woody_biomass_C_g_m, y = mean_ndvi_10m)) + 
    geom_point(size = 2) +  
    geom_line(aes(y = pred_mod12), linetype = 1, size = 2) + 
    geom_ribbon( aes(ymin = lcl_mod12, ymax = ucl_mod12, color = NULL, show.legend = FALSE), alpha = .15) +
    geom_line(aes(y= lcl_mod12), linetype = 'longdash', size = 1) + 
    geom_line(aes(y=ucl_mod12), linetype='longdash', size = 1) +
    labs(x=expression(C~mass~(g~C~m^-2))) +
    reg_theme + 
  scale_y_continuous(breaks = seq(0.4, 0.8, by = .1), name = "NDVI (10m)")

plot12
```


```{r}
compareGLM(mod7, mod8, mod9, mod10, mod11, mod12)
```

# Combine Summary output 

## GCC models
```{r}
gcc_sum1 = rbind(mod1_df3, mod2_df3)
gcc_sum2 = rbind(mod3_df3, mod4_df3)
gcc_sum3 = rbind(mod5_df3, mod6_df3)

gcc_combo1 = rbind(gcc_sum1, gcc_sum2)
gcc_combo2 = rbind(gcc_combo1, gcc_sum3)

gcc_combo2

```
Calculate delta AIC
https://stats.stackexchange.com/questions/232465/how-to-compare-models-on-the-basis-of-aic

```{r}
gcc_combo2_data = gcc_combo2 %>%
  mutate(min_AIC = -243.1499) %>%
  mutate(dAIC = round((AIC-min_AIC), 4))

gcc_combo2_data
```

## NDVI models

```{r}
ndvi_sum4 = rbind(mod7_df3, mod8_df3)
ndvi_sum5 = rbind(mod9_df3, mod10_df3)
ndvi_sum6 = rbind(mod11_df3, mod12_df3)

combo_ndvi1 = rbind(ndvi_sum4, ndvi_sum5)
combo_ndvi2 = rbind(combo_ndvi1, ndvi_sum6)
combo_ndvi2
```
Calculate delta AIC
https://stats.stackexchange.com/questions/232465/how-to-compare-models-on-the-basis-of-aic
```{r}
ndvi_combo2_data = combo_ndvi2 %>%
  mutate(min_AIC = -109.48156) %>%
  mutate(dAIC = round((AIC-min_AIC), 4))

ndvi_combo2_data
```

### Combine NDVI and GCC

```{r}
gcc_ndvi_data = rbind(gcc_combo2_data ,ndvi_combo2_data)
gcc_ndvi_data
```


### Save to  csv
```{r eval=FALSE, include=FALSE}
write.csv(gcc_ndvi_data, '../outputs/model_summary/2020-06-07_all-woody-biomass-gcc-ndvi-dAIC.csv', row.names = F)
```


# lm Combine Summary output 

## lm GCC models
```{r}
gcc_fit1 = rbind(fit1_df3, fit2_df3)
gcc_fit2 = rbind(fit3_df3, fit4_df3)
gcc_fit3 = rbind(fit5_df3, fit6_df3)

gcc_fit4 = rbind(gcc_fit1, gcc_fit2)
gcc_fit5 = rbind(gcc_fit4, gcc_fit3)

gcc_fit5

```
Calculate delta AIC
https://stats.stackexchange.com/questions/232465/how-to-compare-models-on-the-basis-of-aic

```{r}
gcc_fit5_data = gcc_fit5 %>%
  mutate(min_AIC = -404.0711) %>%
  mutate(dAIC = round((AIC-min_AIC), 4))

gcc_fit5_data
```

## NDVI models

```{r}
ndvi_fit4 = rbind(fit7_df3, fit8_df3)
ndvi_fit5 = rbind(fit9_df3, fit10_df3)
ndvi_fit6 = rbind(fit11_df3, fit12_df3)

ndvi_fit7 = rbind(ndvi_fit4, ndvi_fit5)
ndvi_fit8 = rbind(ndvi_fit7, ndvi_fit6)
ndvi_fit8 

```
Calculate delta AIC
https://stats.stackexchange.com/questions/232465/how-to-compare-models-on-the-basis-of-aic
```{r}
ndvi_fit8_data = ndvi_fit8  %>%
  mutate(min_AIC = -202.2936) %>%
  mutate(dAIC = round((AIC-min_AIC), 4))

ndvi_fit8_data
```

### Combine NDVI and GCC

```{r}
gcc_ndvi_data2 = rbind(gcc_fit5_data, ndvi_fit8_data)
gcc_ndvi_data2
```


### Save to  csv
```{r eval=FALSE, include=FALSE}
write.csv(gcc_ndvi_data2, '../outputs/model_summary/2020-07-13_all-woody-biomass-gcc-ndvi-dAIC-lm.csv', row.names = F)
```

# Manuscript Figures 
## GCC only
```{r fig.height=7, fig.width=6}

grid_biomass_gcc = cowplot::plot_grid(plot1, plot2, plot3, plot4, plot5, plot6,   labels = "AUTO", align = "hv", ncol= 2) 
grid_biomass_gcc

```
```{r eval=FALSE, include=FALSE}
ggsave("../figures/2020-05-20_Biomass-all-woody-gcc.jpeg", plot = grid_biomass_gcc, width = 6, height = 7, units = c("in"), dpi=600 )
```

## NDVI Only
```{r fig.height=7, fig.width=6}

grid_biomass_ndvi = cowplot::plot_grid(plot7, plot8, plot9, plot10, plot11, plot12, labels = "AUTO", align = "hv", ncol= 2, label_size = 12) 
grid_biomass_ndvi

```

```{r eval=FALSE, include=FALSE}
ggsave("../figures/2020-05-20_Biomass-all-woody-ndvi.jpeg", plot = grid_biomass_ndvi, width = 6, height = 7, units = c("in"), dpi=600 )
```

## GCC and NDVI

### Axis labels 3 columns
```{r fig.height=7, fig.width=6}

fig1 = cowplot::plot_grid(plot1, plot2, plot3, plot4, plot5, plot6, plot7, plot8, plot9, plot10, plot11, plot12, labels = "AUTO", align = "hv", label_size = 12, ncol= 3) + 
  theme(plot.margin = margin(0, 0, 0, 0)) 
  

fig1
```

```{r eval=FALSE, include=FALSE}
ggsave("../figures/2020-06-07_Biomass-live-woody-ndvi-gcc.jpeg", plot = fig1, width = 6, height = 7, units = c("in"), dpi=600 )
```

```{r fig.height=7, fig.width=6}

fig2 = cowplot::plot_grid(plot1, plot2, plot3, plot4, plot5, plot6, plot7, plot8, plot9, plot10, plot11, plot12, labels = "AUTO", align = "hv", label_size = 12, ncol= 3) + 
  theme(plot.margin = margin(0, 0, 0, 0)) +
  draw_label("*", x = .285, y = .59, size = 36, fontface = "bold") +
  draw_label("*", x = .285, y = .835, size = 36, fontface = "bold") +
  draw_label("*", x = .63, y = .59, size = 36, fontface = "bold") +
  draw_label("*", x = .63, y = .835, size = 36, fontface = "bold") +
  draw_label("*", x = .96, y = .59, size = 36, fontface = "bold") +
  draw_label("*", x = .96, y = .835, size = 36, fontface = "bold") +
  
  draw_label("*", x = .285, y = .34, size = 36, fontface = "bold") +
  draw_label("*", x = .285, y = .09, size = 36, fontface = "bold") +
  draw_label("*", x = .63, y = .34, size = 36, fontface = "bold") +
  draw_label("*", x = .63, y = .09, size = 36, fontface = "bold") +
  draw_label("*", x = .96, y = .34, size = 36, fontface = "bold") +
  draw_label("*", x = .96, y = .09, size = 36, fontface = "bold") 
  

fig2
```

```{r eval=FALSE, include=FALSE}
ggsave("../figures/2020-07-02_Biomass-live-woody-ndvi-gcc_sig.jpeg", plot = fig2, width = 6, height = 7, units = c("in"), dpi=600 )
```

## lm fig

```{r fig.height=7, fig.width=6}

lm_fig1 = cowplot::plot_grid(p1, p2, p3, p4, p5, p6, p7, p8, p9, p10, p11, p12, labels = "AUTO", align = "hv", label_size = 12, ncol= 3) + 
  theme(plot.margin = margin(0, 0, 0, 0)) +
  draw_label("*", x = .285, y = .59, size = 36, fontface = "bold") +
  draw_label("*", x = .285, y = .835, size = 36, fontface = "bold") +
  draw_label("*", x = .63, y = .59, size = 36, fontface = "bold") +
  draw_label("*", x = .63, y = .835, size = 36, fontface = "bold") +
  draw_label("*", x = .96, y = .59, size = 36, fontface = "bold") +
  draw_label("*", x = .96, y = .835, size = 36, fontface = "bold") +
  
  draw_label("*", x = .285, y = .34, size = 36, fontface = "bold") +
  draw_label("*", x = .285, y = .09, size = 36, fontface = "bold") +
  draw_label("*", x = .63, y = .34, size = 36, fontface = "bold") +
  draw_label("*", x = .63, y = .09, size = 36, fontface = "bold") +
  draw_label("*", x = .96, y = .34, size = 36, fontface = "bold") +
  draw_label("*", x = .96, y = .09, size = 36, fontface = "bold") 
  

lm_fig1
```

```{r eval=FALSE, include=FALSE}
ggsave("../figures/2020-07-13_Biomass-live-woody-ndvi-gcc-lm.jpeg", plot = lm_fig1, width = 6, height = 7, units = c("in"), dpi=600 )
```

